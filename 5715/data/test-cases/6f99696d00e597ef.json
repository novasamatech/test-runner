{"uid":"6f99696d00e597ef","name":"test_rpc_method_is_available[Test for Moonriver, url: wss://moonriver.public.curie.radiumblock.co/ws]","fullName":"tests.test_rpc_methods_availability#test_rpc_method_is_available","historyId":"3277e8d0478087d8a716ae25788e594a","time":{"start":1726650393111,"stop":1726650393111,"duration":0},"status":"broken","statusMessage":"websocket._exceptions.WebSocketConnectionClosedException: Connection to remote host was lost.","statusTrace":"request = <SubRequest 'connection_by_url' for <Function test_rpc_method_is_available[Test for Moonriver, url: wss://moonriver.public.curie.radiumblock.co/ws]>>\n\n    @pytest.fixture(scope=\"module\", params=collect_nodes_for_chains(get_substrate_chains()), ids=task_ids)\n    def connection_by_url(request):\n        data = request.param\n        connection = execute_with_timeout(\n            timeout=FIXTURE_TIMEOUT,\n            function=create_connection_by_url,\n            args=(data[\"url\"],),\n            error_message=f'Timeout {FIXTURE_TIMEOUT} when creating connection: {data[\"url\"]}'\n        )\n>       execute_with_timeout(\n            timeout=FIXTURE_TIMEOUT,\n            function=get_properties,\n            args=(connection,),\n            error_message=f'Timeout {FIXTURE_TIMEOUT} when getting properties: {data[\"url\"]}'\n        )\n\ntests/conftest.py:46: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/conftest.py:29: in execute_with_timeout\n    return func_timeout(timeout=timeout, func=function, args=args)\n.venv/lib/python3.10/site-packages/func_timeout/dafunc.py:108: in func_timeout\n    raise_exception(exception)\n.venv/lib/python3.10/site-packages/func_timeout/py3_raise.py:7: in raise_exception\n    raise exception[0] from None\nscripts/utils/metadata_interaction.py:68: in get_properties\n    substrate.get_constant('system', 'ss58Prefix')\n.venv/lib/python3.10/site-packages/substrateinterface/base.py:2133: in get_constant\n    constant = self.get_metadata_constant(module_name, constant_name, block_hash=block_hash)\n.venv/lib/python3.10/site-packages/substrateinterface/base.py:2107: in get_metadata_constant\n    self.init_runtime(block_hash=block_hash)\n.venv/lib/python3.10/site-packages/substrateinterface/base.py:691: in init_runtime\n    self.metadata = self.get_block_metadata(block_hash=runtime_block_hash, decode=True)\n.venv/lib/python3.10/site-packages/substrateinterface/base.py:518: in get_block_metadata\n    response = self.rpc_request(\"state_getMetadata\", params)\n.venv/lib/python3.10/site-packages/substrateinterface/base.py:323: in rpc_request\n    self.__rpc_message_queue.append(json.loads(self.websocket.recv()))\n.venv/lib/python3.10/site-packages/websocket/_core.py:388: in recv\n    opcode, data = self.recv_data()\n.venv/lib/python3.10/site-packages/websocket/_core.py:416: in recv_data\n    opcode, frame = self.recv_data_frame(control_frame)\n.venv/lib/python3.10/site-packages/websocket/_core.py:437: in recv_data_frame\n    frame = self.recv_frame()\n.venv/lib/python3.10/site-packages/websocket/_core.py:478: in recv_frame\n    return self.frame_buffer.recv_frame()\n.venv/lib/python3.10/site-packages/websocket/_abnf.py:363: in recv_frame\n    self.recv_header()\n.venv/lib/python3.10/site-packages/websocket/_abnf.py:319: in recv_header\n    header = self.recv_strict(2)\n.venv/lib/python3.10/site-packages/websocket/_abnf.py:398: in recv_strict\n    bytes_ = self.recv(min(16384, shortage))\n.venv/lib/python3.10/site-packages/websocket/_core.py:563: in _recv\n    return recv(self.sock, bufsize)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nsock = <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>\nbufsize = 2\n\n    def recv(sock: socket.socket, bufsize: int) -> bytes:\n        if not sock:\n            raise WebSocketConnectionClosedException(\"socket is already closed.\")\n    \n        def _recv():\n            try:\n                return sock.recv(bufsize)\n            except SSLWantReadError:\n                pass\n            except socket.error as exc:\n                error_code = extract_error_code(exc)\n                if error_code not in [errno.EAGAIN, errno.EWOULDBLOCK]:\n                    raise\n    \n            sel = selectors.DefaultSelector()\n            sel.register(sock, selectors.EVENT_READ)\n    \n            r = sel.select(sock.gettimeout())\n            sel.close()\n    \n            if r:\n                return sock.recv(bufsize)\n    \n        try:\n            if sock.gettimeout() == 0:\n                bytes_ = sock.recv(bufsize)\n            else:\n                bytes_ = _recv()\n        except TimeoutError:\n            raise WebSocketTimeoutException(\"Connection timed out\")\n        except socket.timeout as e:\n            message = extract_err_message(e)\n            raise WebSocketTimeoutException(message)\n        except SSLError as e:\n            message = extract_err_message(e)\n            if isinstance(message, str) and \"timed out\" in message:\n                raise WebSocketTimeoutException(message)\n            else:\n                raise\n    \n        if not bytes_:\n>           raise WebSocketConnectionClosedException(\"Connection to remote host was lost.\")\nE           websocket._exceptions.WebSocketConnectionClosedException: Connection to remote host was lost.\n\n.venv/lib/python3.10/site-packages/websocket/_socket.py:129: WebSocketConnectionClosedException","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":2,"retriesStatusChange":false,"beforeStages":[{"name":"connection_by_url","time":{"start":1726650351909,"stop":1726650367458,"duration":15549},"status":"broken","statusMessage":"tests.conftest.FixtureTimeoutError: Timeout 15 when getting properties: wss://moonriver.public.curie.radiumblock.co/ws\n","statusTrace":"  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/_pytest/fixtures.py\", line 1128, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/_pytest/fixtures.py\", line 907, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/tests/conftest.py\", line 46, in connection_by_url\n    execute_with_timeout(\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/tests/conftest.py\", line 34, in execute_with_timeout\n    raise FixtureTimeoutError(error_message)\n","steps":[{"name":"Function timed out","time":{"start":1726650367457,"stop":1726650367458,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"70739d22d643d8a2","name":"Error","source":"70739d22d643d8a2.txt","type":"text/plain","size":82}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":1,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"connection_by_url","time":{"start":1726650372481,"stop":1726650388090,"duration":15609},"status":"broken","statusMessage":"tests.conftest.FixtureTimeoutError: Timeout 15 when getting properties: wss://moonriver.public.curie.radiumblock.co/ws\n","statusTrace":"  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/_pytest/fixtures.py\", line 1128, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/_pytest/fixtures.py\", line 907, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/tests/conftest.py\", line 46, in connection_by_url\n    execute_with_timeout(\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/tests/conftest.py\", line 34, in execute_with_timeout\n    raise FixtureTimeoutError(error_message)\n","steps":[{"name":"Function timed out","time":{"start":1726650388090,"stop":1726650388090,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"a214d7a72091dcc4","name":"Error","source":"a214d7a72091dcc4.txt","type":"text/plain","size":82}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":1,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"connection_by_url","time":{"start":1726650393111,"stop":1726650401906,"duration":8795},"status":"broken","statusMessage":"websocket._exceptions.WebSocketConnectionClosedException: Connection to remote host was lost.\n","statusTrace":"  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/_pytest/fixtures.py\", line 1128, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/_pytest/fixtures.py\", line 907, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/tests/conftest.py\", line 46, in connection_by_url\n    execute_with_timeout(\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/tests/conftest.py\", line 29, in execute_with_timeout\n    return func_timeout(timeout=timeout, func=function, args=args)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/func_timeout/dafunc.py\", line 108, in func_timeout\n    raise_exception(exception)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/func_timeout/py3_raise.py\", line 7, in raise_exception\n    raise exception[0] from None\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/scripts/utils/metadata_interaction.py\", line 68, in get_properties\n    substrate.get_constant('system', 'ss58Prefix')\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/substrateinterface/base.py\", line 2133, in get_constant\n    constant = self.get_metadata_constant(module_name, constant_name, block_hash=block_hash)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/substrateinterface/base.py\", line 2107, in get_metadata_constant\n    self.init_runtime(block_hash=block_hash)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/substrateinterface/base.py\", line 691, in init_runtime\n    self.metadata = self.get_block_metadata(block_hash=runtime_block_hash, decode=True)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/substrateinterface/base.py\", line 518, in get_block_metadata\n    response = self.rpc_request(\"state_getMetadata\", params)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/substrateinterface/base.py\", line 323, in rpc_request\n    self.__rpc_message_queue.append(json.loads(self.websocket.recv()))\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_core.py\", line 388, in recv\n    opcode, data = self.recv_data()\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_core.py\", line 416, in recv_data\n    opcode, frame = self.recv_data_frame(control_frame)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_core.py\", line 437, in recv_data_frame\n    frame = self.recv_frame()\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_core.py\", line 478, in recv_frame\n    return self.frame_buffer.recv_frame()\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_abnf.py\", line 363, in recv_frame\n    self.recv_header()\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_abnf.py\", line 319, in recv_header\n    header = self.recv_strict(2)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_abnf.py\", line 398, in recv_strict\n    bytes_ = self.recv(min(16384, shortage))\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_core.py\", line 563, in _recv\n    return recv(self.sock, bufsize)\n  File \"/home/runner/work/test-runner/test-runner/nova-utils/.venv/lib/python3.10/site-packages/websocket/_socket.py\", line 129, in recv\n    raise WebSocketConnectionClosedException(\"Connection to remote host was lost.\")\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_rpc_methods_availability"},{"name":"host","value":"fv-az1024-328"},{"name":"thread","value":"2121-Dummy-1"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_rpc_methods_availability"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"connection_by_url","value":"{'url': 'wss://moonriver.public.curie.radiumblock.co/ws', 'name': 'Moonriver'}"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"ee155e547e2286a8","status":"broken","statusDetails":"tests.conftest.FixtureTimeoutError: Timeout 15 when getting properties: wss://moonriver.public.curie.radiumblock.co/ws","time":{"start":1726650372480,"stop":1726650372480,"duration":0}},{"uid":"40bb40d896c6e668","status":"broken","statusDetails":"tests.conftest.FixtureTimeoutError: Timeout 15 when getting properties: wss://moonriver.public.curie.radiumblock.co/ws","time":{"start":1726650351908,"stop":1726650351908,"duration":0}}],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":3,"skipped":0,"passed":23,"unknown":0,"total":26},"items":[{"uid":"2858df104801e73d","reportUrl":"https://novasamatech.github.io/test-runner/5714//#testresult/2858df104801e73d","status":"passed","time":{"start":1726585505789,"stop":1726585505904,"duration":115}},{"uid":"ed903256b4525b79","reportUrl":"https://novasamatech.github.io/test-runner/5713//#testresult/ed903256b4525b79","status":"passed","time":{"start":1726563897340,"stop":1726563897449,"duration":109}},{"uid":"a53db07220a6b73e","reportUrl":"https://novasamatech.github.io/test-runner/5712//#testresult/a53db07220a6b73e","status":"passed","time":{"start":1726499101488,"stop":1726499101563,"duration":75}},{"uid":"f936ce16a473ed0a","reportUrl":"https://novasamatech.github.io/test-runner/5711//#testresult/f936ce16a473ed0a","status":"passed","time":{"start":1726477524660,"stop":1726477524795,"duration":135}},{"uid":"fdaf875a5fb57776","reportUrl":"https://novasamatech.github.io/test-runner/5710//#testresult/fdaf875a5fb57776","status":"passed","time":{"start":1726412679734,"stop":1726412679834,"duration":100}},{"uid":"f36dc88424892305","reportUrl":"https://novasamatech.github.io/test-runner/5709//#testresult/f36dc88424892305","status":"passed","time":{"start":1726391085798,"stop":1726391085885,"duration":87}},{"uid":"b6e7c5ff3381cb00","reportUrl":"https://novasamatech.github.io/test-runner/5708//#testresult/b6e7c5ff3381cb00","status":"passed","time":{"start":1726326284918,"stop":1726326285054,"duration":136}},{"uid":"32c20649be74c3b5","reportUrl":"https://novasamatech.github.io/test-runner/5707//#testresult/32c20649be74c3b5","status":"passed","time":{"start":1726304681736,"stop":1726304681829,"duration":93}},{"uid":"9e441d6b7c7569d7","reportUrl":"https://novasamatech.github.io/test-runner/5706//#testresult/9e441d6b7c7569d7","status":"passed","time":{"start":1726239911477,"stop":1726239911554,"duration":77}},{"uid":"128d773614423ece","reportUrl":"https://novasamatech.github.io/test-runner/5705//#testresult/128d773614423ece","status":"passed","time":{"start":1726218287036,"stop":1726218287114,"duration":78}},{"uid":"bde09e96b225c078","reportUrl":"https://novasamatech.github.io/test-runner/5704//#testresult/bde09e96b225c078","status":"passed","time":{"start":1726153493903,"stop":1726153494006,"duration":103}},{"uid":"3c4f041a533aa80f","reportUrl":"https://novasamatech.github.io/test-runner/5703//#testresult/3c4f041a533aa80f","status":"passed","time":{"start":1726131890296,"stop":1726131890428,"duration":132}},{"uid":"247496321da96d07","reportUrl":"https://novasamatech.github.io/test-runner/5702//#testresult/247496321da96d07","status":"passed","time":{"start":1726117741198,"stop":1726117741303,"duration":105}},{"uid":"d587e8ae272a026c","reportUrl":"https://novasamatech.github.io/test-runner/5695//#testresult/d587e8ae272a026c","status":"passed","time":{"start":1725807936092,"stop":1725807936167,"duration":75}},{"uid":"8aaaa7b36b706109","reportUrl":"https://novasamatech.github.io/test-runner/5694//#testresult/8aaaa7b36b706109","status":"passed","time":{"start":1725786280174,"stop":1725786280248,"duration":74}},{"uid":"fed97d2451e423d0","reportUrl":"https://novasamatech.github.io/test-runner/5693//#testresult/fed97d2451e423d0","status":"passed","time":{"start":1725721488120,"stop":1725721488255,"duration":135}},{"uid":"890826c1f2942f78","reportUrl":"https://novasamatech.github.io/test-runner/5692//#testresult/890826c1f2942f78","status":"passed","time":{"start":1725699919797,"stop":1725699919874,"duration":77}},{"uid":"e0b042522bd7c1e2","reportUrl":"https://novasamatech.github.io/test-runner/5691//#testresult/e0b042522bd7c1e2","status":"passed","time":{"start":1725635097731,"stop":1725635097808,"duration":77}},{"uid":"b4c435e66748f0d5","reportUrl":"https://novasamatech.github.io/test-runner/5690//#testresult/b4c435e66748f0d5","status":"passed","time":{"start":1725613501238,"stop":1725613501314,"duration":76}},{"uid":"8091c7dc6f432f34","reportUrl":"https://novasamatech.github.io/test-runner/5689//#testresult/8091c7dc6f432f34","status":"passed","time":{"start":1725548680138,"stop":1725548680252,"duration":114}}]},"tags":[]},"source":"6f99696d00e597ef.json","parameterValues":["{'url': 'wss://moonriver.public.curie.radiumblock.co/ws', 'name': 'Moonriver'}"]}